---
const navItems = [
  { href: '/docs/getting-started/introduction', label: 'Documentation' },
  { href: '/docs/schema-language/overview', label: 'Schema' },
  { href: '/docs/api/reference', label: 'API' },
  { href: 'https://github.com/MarshallOfSound/ipc', label: 'GitHub', external: true },
];
---

<header class="fixed top-0 left-0 right-0 z-50">
  <!-- Backdrop blur container -->
  <div class="absolute inset-0 bg-[--color-bg-primary]/70 backdrop-blur-xl border-b border-[--color-border]"></div>

  <!-- Electric line accent at top -->
  <div class="absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-electron-cyan/50 to-transparent"></div>

  <div class="relative mx-auto flex h-16 max-w-7xl items-center justify-between px-6">
    <!-- Logo -->
    <a href="/" class="group flex items-center gap-2.5 text-[--color-text-primary] transition-all duration-300 hover:text-electron-cyan">
      <!-- Simple Electron Logo -->
      <div class="w-8 h-8 flex items-center justify-center">
        <svg viewBox="0 0 32 32" class="w-full h-full" fill="none">
          <!-- Orbits -->
          <ellipse cx="16" cy="16" rx="14" ry="5.5" stroke="currentColor" stroke-width="1.5" opacity="0.4" transform="rotate(0 16 16)"/>
          <ellipse cx="16" cy="16" rx="14" ry="5.5" stroke="currentColor" stroke-width="1.5" opacity="0.4" transform="rotate(60 16 16)"/>
          <ellipse cx="16" cy="16" rx="14" ry="5.5" stroke="currentColor" stroke-width="1.5" opacity="0.4" transform="rotate(-60 16 16)"/>
          <!-- Nucleus -->
          <circle cx="16" cy="16" r="3" fill="var(--color-electron-cyan)"/>
        </svg>
      </div>

      <span class="text-lg font-semibold tracking-tight">EIPC</span>
    </a>

    <!-- Navigation -->
    <nav class="hidden md:flex items-center gap-1">
      {navItems.map((item) => (
        <a
          href={item.href}
          class="relative px-4 py-2 text-sm font-medium text-[--color-text-secondary] transition-all duration-300 hover:text-electron-cyan group"
          {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
        >
          <span class="relative z-10">{item.label}</span>
          {item.external && (
            <svg class="ml-1 inline-block h-3 w-3 opacity-50 group-hover:opacity-100 transition-opacity" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
          )}
          <!-- Hover background -->
          <span class="absolute inset-0 rounded-lg bg-electron-cyan/0 group-hover:bg-electron-cyan/10 transition-colors"></span>
        </a>
      ))}
    </nav>

    <!-- Right side: Theme toggle -->
    <div class="flex items-center gap-4">
      <button
        id="theme-toggle"
        class="theme-toggle"
        aria-label="Toggle theme"
        type="button"
      >
        <!-- Sun icon (visible in light mode) -->
        <svg class="sun-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="4"/>
          <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
        </svg>

        <!-- Moon icon (visible in dark mode) -->
        <svg class="moon-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>

      <!-- Mobile menu button -->
      <button
        id="mobile-menu-btn"
        class="md:hidden theme-toggle"
        aria-label="Open menu"
        type="button"
      >
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>
  </div>
</header>

<!-- Mobile menu -->
<div id="mobile-menu" class="fixed inset-0 z-40 hidden">
  <div class="absolute inset-0 bg-[--color-bg-primary]/95 backdrop-blur-xl"></div>
  <nav class="relative flex flex-col items-center justify-center h-full gap-8">
    {navItems.map((item) => (
      <a
        href={item.href}
        class="text-2xl font-semibold text-[--color-text-primary] hover:text-electron-cyan transition-colors"
        {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
      >
        {item.label}
      </a>
    ))}
  </nav>
</div>

<script>
  function initMobileMenu() {
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');

    if (!btn || !menu) return;

    btn.addEventListener('click', () => {
      menu.classList.toggle('hidden');
      document.body.classList.toggle('overflow-hidden');
    });

    menu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        menu.classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
      });
    });
  }

  initMobileMenu();
  document.addEventListener('astro:after-swap', initMobileMenu);
</script>

<!-- Spacer to prevent content from hiding behind fixed header -->
<div class="h-16"></div>
